 var excelData = originExcelData = [
            {
                ShareClass_Launch: '12/27/2008',
                ShareClass_CCY: 'USD',
                Subfund_Launch: '12/27/2008',
                ShareClass: 'Class A',
                ISIN: 'IE00ABC1234',
                header: '#,Class A USD,Russell 2000 Index,MSCI AC Asia Pacific ex Japan Index',
                list: [
                    {
                        date: '12/31/2012',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: -0.123
                            }, {
                                label: 'Russell 2000 Index',
                                value: -0.123
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0
                            }
                        ]
                    }, {
                        date: '12/31/2013',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: -0.233
                            }, {
                                label: 'Russell 2000 Index',
                                value: -0.224
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0
                            }
                        ]
                    }, {
                        date: '12/31/2014',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: 0.033
                            }, {
                                label: 'Russell 2000 Index',
                                value: 0.033
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0
                            }
                        ]
                    }, {
                        date: '12/31/2015',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: 0.521
                            }, {
                                label: 'Russell 2000 Index',
                                value: 0.521
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0
                            }
                        ]
                    }, {
                        date: '12/31/2016',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: 0.156
                            }, {
                                label: 'Russell 2000 Index',
                                value: 0.156
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0.200
                            }
                        ]
                    }, {
                        date: '12/31/2017',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: 0.012
                            }, {
                                label: 'Russell 2000 Index',
                                value: 0.012
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0.200
                            }
                        ]
                    }, {
                        date: '12/31/2018',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: 0.123
                            }, {
                                label: 'Russell 2000 Index',
                                value: 0.132
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0.200
                            }
                        ]
                    }, {
                        date: '12/31/2019',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: 0.204
                            }, {
                                label: 'Russell 2000 Index',
                                value: 0.213
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0.200
                            }
                        ]
                    }, {
                        date: '12/31/2020',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: 0.654
                            }, {
                                label: 'Russell 2000 Index',
                                value: 0.663
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0.200
                            }
                        ]
                    }, {
                        date: '12/31/2021',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: 0.145
                            }, {
                                label: 'Russell 2000 Index',
                                value: 0.154
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0.200
                            }
                        ]
                    }, {
                        date: '12/31/2022',
                        detail: [
                            {
                                label: 'Class A USD',
                                value: 0.555
                            }, {
                                label: 'Russell 2000 Index',
                                value: 0.555
                            }, {
                                label: 'MSCI AC Asia Pacific ex Japan Index',
                                value: 0.200
                            }
                        ]
                    }
                ]
            },
            {
                ShareClass_Launch: '5/20/2015',
                ShareClass_CCY: 'EUR',
                Subfund_Launch: '07/01/2011',
                ShareClass: 'Class B',
                ISIN: 'IE001234ABC',
                header: '#,Class B EUR,S&P Equity index,FTSE 100 Index',
                list: [
                    {
                        date: '12/31/2016',
                        detail: [
                            {
                                label: 'Class B EUR',
                                value: 0.150
                            },
                            {
                                label: 'S&P Equity index',
                                value: 0.300
                            },
                            {
                                label: 'FTSE 100 Index',
                                value: 0.300
                            }
                        ]
                    }, {
                        date: '12/31/2017',
                        detail: [
                            {
                                label: 'Class B EUR',
                                value: 0
                            },
                            {
                                label: 'S&P Equity index',
                                value: 0.300
                            },
                            {
                                label: 'FTSE 100 Index',
                                value: 0.208
                            }
                        ]
                    }, {
                        date: '12/31/2018',
                        detail: [
                            {
                                label: 'Class B EUR',
                                value: 0
                            },
                            {
                                label: 'S&P Equity index',
                                value: 0.300
                            },
                            {
                                label: 'FTSE 100 Index',
                                value: 0.300
                            }
                        ]
                    }, {
                        date: '12/31/2019',
                        detail: [
                            {
                                label: 'Class B EUR',
                                value: 0.150
                            },
                            {
                                label: 'S&P Equity index',
                                value: 0.300
                            },
                            {
                                label: 'FTSE 100 Index',
                                value: 0.208
                            }
                        ]
                    }, {
                        date: '12/31/2020',
                        detail: [
                            {
                                label: 'Class B EUR',
                                value: 0.150
                            },
                            {
                                label: 'S&P Equity index',
                                value: -0.250
                            },
                            {
                                label: 'FTSE 100 Index',
                                value: -0.260
                            }
                        ]
                    }, {
                        date: '12/31/2021',
                        detail: [
                            {
                                label: 'Class B EUR',
                                value: 0.150
                            },
                            {
                                label: 'S&P Equity index',
                                value: 0.300
                            },
                            {
                                label: 'FTSE 100 Index',
                                value: 0.300
                            }
                        ]
                    }, {
                        date: '12/31/2022',
                        detail: [
                            {
                                label: 'Class B EUR',
                                value: 0.154
                            },
                            {
                                label: 'S&P Equity index',
                                value: 0.300
                            },
                            {
                                label: 'FTSE 100 Index',
                                value: 0.208
                            }
                        ]
                    }
                ]
            }
        ]

        var filteredArray = [];
        var filteredArray2 = [];

        //... Change past performance
        var year;
        $("#past-performance").change(function () {
            console.log(year);
            $("#dynamic-year-text").text(" is " + year);
            var that = this;
            filteredArray = excelData.filter(function (item) {
                return item.ShareClass_CCY == $(that).val()
            });
            if (chart != null) {
                $("#chart-container").empty();
                $("#dynamic-year-chart-container").empty();
            }

            $("#dynamic-currency-text").html($(this).val());
            $("#numberYear").text(filteredArray[0].list.length);
            
            drawChart(filteredArray, $(this).val());
            drawYear(filteredArray[0].list[filteredArray[0].list.length - 1].date.slice(-4), filteredArray[0].list[0].date.slice(-4));        
        })

        
        drawYear(2022, 2011);
        function drawYear(start, end){
            //... Change year            
            $("#years").html("<option value=''>Select Year</option>")
            for (var i = start; i >= end; i--) {
                var option = `<option value=` + i + `>` + i + `</option>`;
                if($('#years > option').length < 12){
                    $("#years").append(option)
                }
            }
        }

        $("#years").change(function () {
            var tmpArr = excelData.filter(function (item) {
                return item.ShareClass_CCY == $("#past-performance").val()
            });

            if($(this).val() != ""){
                $("#dynamic-year-chart-container").empty();
                drawChart(tmpArr[0].list.filter(year => year.date.includes($(this).val())), $("#past-performance").val(), true);
            }
        })

        function filterByValue(array, string) {
            return array.filter(o => Object.keys(o).some(k => o[k].toLowerCase().includes(string.toLowerCase())));
        }

        function yearFromDate(data){
            return data.slice(-4);
        }

        //... draw chart
        drawChart(excelData, 'USD');
        $('.performance-container').each(function (i) {
            if(i === 1){
                $(this).empty();
            }
        })
        function drawChart(excelData, filterKey, chooseYear=false) {
            anychart.onDocumentReady(function () {
                if (excelData[0].ShareClass_Launch && excelData.length !== 0) {
                    filteredArray2 = excelData.filter(function (item) {
                        return item.ShareClass_CCY == filterKey
                    });
                    var rowArr = [];
                    filteredArray2.forEach(element => {
                        var rowArr1 = [];
                        element.list.forEach(item => {
                            var tmpArr1 = [];
                            var tmpArr2 = [];
                            if (item.detail.length > 0) {
                                item.detail.forEach(i => {
                                    tmpArr2.push(i.value * 100)
                                });
                            }
                            tmpArr1.push(item.date.slice(-4), ...tmpArr2);
                            rowArr1.push(tmpArr1)
                        });
                        rowArr.push(...rowArr1)
                    });

                } else {
                    var rowArr = [];
                    var rowArr1 = [];
                    excelData.forEach(item => {
                        var tmpArr1 = [];
                        var tmpArr2 = [];
                        if (item.detail.length > 0) {
                            item.detail.forEach(i => {
                                tmpArr2.push(i.value * 100)
                            });
                        }
                        tmpArr1.push(item.date.slice(-4), ...tmpArr2);
                        rowArr1.push(tmpArr1)
                    });
                    rowArr.push(...rowArr1)
                }

                var header = [];
                if(excelData[0].list){
                    year = excelData[0].list[0].date.slice(-4);
                }else{
                    year = excelData[0].date.slice(-4);
                }

                if(chooseYear == false){
                    excelData.forEach(element => {
                        var filterHeader = [];
                        var tmpArr = element.header.split(",");
                        tmpArr.forEach(element => {
                            filterHeader.push(element)
                        });
                        if(filterKey == element.ShareClass_CCY){
                            header = filterHeader;
                        }
                    });
                }else{
                    originExcelData.forEach(element => {
                        var filterHeader = [];
                        var tmpArr = element.header.split(",");
                        tmpArr.forEach(element => {
                            filterHeader.push(element)
                        });
                        if(filterKey == element.ShareClass_CCY){
                            header = filterHeader;
                        }
                    });
                }
                var chartData = {
                    header: header,
                    rows: rowArr
                };

                // create column chart
                chart = anychart.column();

                // set chart data
                chart.data(chartData);

                // turn on chart animation
                chart.animation(true);

                // set chart title text settings
                chart.interactivity().hoverMode('single');

                // set axis settings
                chart.xAxis().value(0).labels(false);
                chart.xAxis(2).stroke(null).orientation('bottom');
                chart.yAxis().labels().format('{%Value}%');

                chart.labels(true);
                labels1 = chart.getSeries(0).labels();
                labels1.offsetY(0);
                labels1.rotation(-270);
                labels2 = chart.getSeries(1).labels();
                labels2.offsetY(0);
                labels2.rotation(-270);
                labels3 = chart.getSeries(2).labels();
                labels3.offsetY(0);
                labels3.rotation(-270);

                chart
                    .tooltip()
                    .title(false)
                    .separator(false)
                    .format('{%Name} {%Value}{decimalSeparator:\\,}');

                // turn on legend
                chart.legend().enabled(true).fontSize(13).padding([0, 0, 20, 0]);
                chart.legend().position("bottom");
                chart.legend().itemsLayout("vertical");
                chart.legend().margin().top(20);
                chart.legend().padding().bottom(0);

                // turn on grids
                chart.yGrid().stroke('#ddd').drawLastLine(false);
                chart.barsPadding(0);
                chart.barGroupsPadding(0.5);
                chart.palette(
                    anychart.palettes.distinctColors().items(["#FF7700", "#001C4B", "#00FFFF"])
                );

                // set container id for the chart
                chart.container('chart-container');
                chart.draw();

                if(chooseYear == true){
                    chart.container('dynamic-year-chart-container');
                    chart.draw();
                }

                //... export csv of chart
                $(".download-btn").click(function () {
                    chart.saveAsXlsx('default', "excel");
                })
            });
            if(excelData.length > 1){
                $("#dynamic-year-text").html(" is "+  yearFromDate(excelData[0].list[0].date));
                $("#numberYear").text(excelData[0].list.length);
            }
        }

        $("#performancepicker").datepicker({
            dateFormat: "dd / mm / yy",
            duration: "fast"
        });

        $("#dynamic-currency-text").html("USD");

        var selectArr = [];
        excelData.forEach(element => {
            var option = `<option value="` + element.ShareClass_CCY + `">` + element.ShareClass + ` + ` + element.ShareClass_CCY + `</option>`;            
            selectArr.push(option);
        });
        $("#past-performance").html(selectArr);
